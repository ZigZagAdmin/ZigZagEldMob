<!-- <ion-header>
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-back-button></ion-back-button>
    </ion-buttons>
    <ion-title>Edit Dvir</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <form [formGroup]="form">
    <ion-row class="ion-align-items-center ion-justify-content-center">
      <ion-col size="4">
        <ion-label class="ion-text-center">Company</ion-label>
      </ion-col>
      <ion-col size="8">
        <ion-item>
          <ion-input readonly [value]="company?.Name"></ion-input>
        </ion-item>
      </ion-col>
    </ion-row>

    <ion-row class="ion-text-start">
      <ion-col>
        <ion-label>Time</ion-label>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col size="6">
        <ion-item>
          <ion-icon
            name="calendar-outline"
            slot="start"
            size="small"
          ></ion-icon>
          <ion-input type="text" formControlName="Date" readonly="true">
          </ion-input
        ></ion-item>
      </ion-col>

      <ion-col size="6">
        <ion-item>
          <ion-icon name="time-outline" slot="start" size="small"></ion-icon>
          <ion-input
            type="text"
            formControlName="Time"
            readonly="true"
          ></ion-input>
        </ion-item>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col>
        <ion-label class="ion-text-center">Location</ion-label>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col>
        <ion-item>
          <ion-icon
            name="location-outline"
            slot="start"
            size="small"
          ></ion-icon>
          <ion-input
            readonly="true"
            formControlName="LocationDescription"
          ></ion-input>
        </ion-item>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col>
        <ion-label class="ion-text-center">Vehicle</ion-label>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col size="6">
        <ion-item>
          <ion-icon name="car-outline" slot="start" size="small"></ion-icon>
          <ion-input readonly formControlName="VehicleUnit"></ion-input>
        </ion-item>
      </ion-col>

      <ion-col size="6">
        <ion-item>
          <ion-icon
            name="speedometer-outline"
            slot="start"
            size="small"
          ></ion-icon>
          <ion-input
            readonly="true"
            formControlName="Odometer"
            type="text"
          ></ion-input>
        </ion-item>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col>
        <ion-list>
          <ion-item>
            <ion-icon
              name="construct-outline"
              slot="start"
              size="small"
            ></ion-icon>
            <ion-select
              formControlName="DefectsVehicle"
              aria-label="Vehicle Defects"
              placeholder="Defects"
              [multiple]="true"
            >
              <ion-select-option
                *ngFor="let defect of defectsVehicle"
                [value]="defect"
                >{{ defect }}</ion-select-option
              >
            </ion-select>
          </ion-item>
        </ion-list>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col>
        <ion-label class="ion-text-center">Trailers</ion-label>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col>
        <ion-item>
          <ion-icon name="train-outline" slot="start" size="small"></ion-icon>
          <ion-input
            placeholder="Trailers"
            formControlName="Trailers"
          ></ion-input>
        </ion-item>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col>
        <ion-list>
          <ion-item>
            <ion-icon
              name="construct-outline"
              slot="start"
              size="small"
            ></ion-icon>
            <ion-select
              formControlName="DefectsTrailers"
              aria-label="Trailer Defects"
              placeholder="Defects"
              [multiple]="true"
            >
              <ion-select-option
                *ngFor="let defect of defectsTrailers"
                [value]="defect"
                >{{ defect }}</ion-select-option
              >
            </ion-select>
          </ion-item>
        </ion-list>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col>
        <ion-label class="ion-text-center">Remarks</ion-label>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col>
        <ion-item>
          <ion-icon name="chatbox-outline" slot="start" size="small"></ion-icon>
          <ion-input
            type="text"
            formControlName="Remarks"
            placeholder="Remarks"
          ></ion-input>
        </ion-item>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col>
        <ion-label class="ion-text-center">Status</ion-label>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col>
        <ion-list>
          <ion-item>
            <ion-icon
              *ngIf="form.value.StatusCode === 'VCS' || form.value.StatusCode === 'DC'"
              name="checkmark-circle-outline"
              slot="start"
              size="small"
              color="success"
            ></ion-icon>
            <ion-icon
              *ngIf="form.value.StatusCode === 'D' || form.value.StatusCode === 'DNNBC'"
              name="alert-circle-outline"
              slot="start"
              size="small"
              color="danger"
            ></ion-icon>
            <ion-select aria-label="DVIR status" formControlName="StatusCode">
              <ion-select-option
                *ngFor="let status of DvirStatuses"
                [value]="status.StatusCode"
                >{{ status.StatusName }}</ion-select-option
              >
            </ion-select>
          </ion-item>
        </ion-list>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col>
        <ion-label class="ion-text-center">Signature</ion-label>
      </ion-col>
    </ion-row>

    <ion-row class="ion-justify-content-center">
      <ion-col size="auto">
        <canvas
          #sPad
          width="250"
          height="200"
          style="touch-action: none; border: 1px solid black"
        ></canvas>
      </ion-col>
    </ion-row>

    <ion-row class="ion-justify-content-center">
      <ion-col size="auto">
        <span (click)="clearSignature()" class="underline-text">
          Clear Signature
        </span>
      </ion-col>
    </ion-row>

    <div *ngIf="form.value.StatusCode === 'DC'" class="mechanical-signature">
      <ion-row>
        <ion-col>
          <ion-label class="ion-text-center">Mechanical Signature</ion-label>
        </ion-col>
      </ion-row>

      <ion-row class="ion-justify-content-center">
        <ion-col size="auto">
          <canvas
            required
            #mechanicSPad
            width="250"
            height="200"
            style="touch-action: none; border: 1px solid black"
          ></canvas>
        </ion-col>
      </ion-row>

      <ion-row class="ion-justify-content-center">
        <ion-col size="auto">
          <span (click)="clearMechanicSignature()" class="underline-text">
            Clear Signature
          </span>
        </ion-col>
      </ion-row>
    </div>

    <ion-row class="ion-justify-content-center">
      <ion-col>
        <ion-button
          [disabled]="!form.valid"
          color="success"
          (click)="onSubmit()"
          expand="block"
        >
          Sign
        </ion-button>
      </ion-col>
    </ion-row>
  </form>
</ion-content> -->

<ion-content>
  <app-header [title]="'Edit Dvir'" [backButton]="true" (backButtonCallback)="goBack()"></app-header>
  <form class="edit-form" [formGroup]="form">
    <p class="subtitle-lg">General Info</p>
    <div class="edit-dvir-block">
      <div class="input-block-2">
        <p class="text-2">Company</p>
        <input class="input-2 readonly" type="text" [value]="company?.name" readonly />
      </div>
      <div class="input-block-2">
        <p class="text-2">Time</p>
        <div class="two-inputs">
          <input class="input-2 readonly width-50" type="text" formControlName="Date" readonly />
          <input class="input-2 readonly width-50" type="text" formControlName="Time" readonly />
        </div>
      </div>
      <div class="input-block-2">
        <p class="text-2">Location</p>
        <input class="input-2 readonly" type="text" formControlName="LocationDescription" readonly />
      </div>
    </div>
    <p class="subtitle-lg">Vehicle Info</p>
    <div class="edit-dvir-block">
      <div class="input-block-2">
        <p class="text-2">Vehicle Name</p>
        <input class="input-2 readonly" type="text" formControlName="VehicleUnit" readonly />
      </div>
      <div class="input-block-2">
        <p class="text-2">Odometer</p>
        <input class="input-2 readonly" type="text" formControlName="Odometer" readonly />
      </div>
      <div class="input-block-2">
        <p class="text-2">Vehicle Defects (Optional)</p>
        <select class="input-2 select" type="text" formControlName="DefectsVehicle">
          <option *ngFor="let defect of defectsVehicle" [value]="defect">{{ defect }}</option>
        </select>
      </div>
    </div>
    <p class="subtitle-lg">Trailer Info</p>
    <div class="edit-dvir-block">
      <div class="input-block-2">
        <p class="text-2">Trailer Name</p>
        <input class="input-2" type="text" formControlName="Trailers" />
      </div>
      <div class="input-block-2">
        <p class="text-2">Trailer Defects (Optional)</p>
        <select class="input-2 select" type="text" formControlName="DefectsTrailers">
          <option *ngFor="let defect of defectsTrailers" [value]="defect">{{ defect }}</option>
        </select>
      </div>
    </div>
    <p class="subtitle-lg">Status</p>
    <div class="edit-dvir-block">
      <div class="input-block-2">
        <p class="text-2">Status</p>
        <div class="statuses">
          <div class="status" (click)="switchStatus('VCS')">
            <img src="assets/icon/satis-success.svg" alt="ok" />
            <p class="text-success">Satisfactory Condition</p>
            <img *ngIf="form.value.StatusCode !== 'VCS'" src="assets/icon/circle-white.svg" alt="circle" />
            <img *ngIf="form.value.StatusCode === 'VCS'" src="assets/icon/check-mark.svg" alt="circle" />
          </div>
          <div class="status" (click)="switchStatus('D')">
            <img src="assets/icon/satis-error.svg" alt="ok" />
            <p class="text-error">Has Defects</p>
            <img *ngIf="form.value.StatusCode !== 'D'" src="assets/icon/circle-white.svg" alt="circle" />
            <img *ngIf="form.value.StatusCode === 'D'" src="assets/icon/check-mark.svg" alt="circle" />
          </div>
          <div class="status" (click)="switchStatus('DC')">
            <img src="assets/icon/satis-success.svg" alt="ok" />
            <p class="text-success">Defects Corrected</p>
            <img *ngIf="form.value.StatusCode !== 'DC'" src="assets/icon/circle-white.svg" alt="circle" />
            <img *ngIf="form.value.StatusCode === 'DC'" src="assets/icon/check-mark.svg" alt="circle" />
          </div>
          <div class="status" (click)="switchStatus('DNNBC')">
            <img src="assets/icon/satis-error.svg" alt="ok" />
            <p class="text-error">Defects Need Not To Be Corrected</p>
            <img *ngIf="form.value.StatusCode !== 'DNNBC'" src="assets/icon/circle-white.svg" alt="circle" />
            <img *ngIf="form.value.StatusCode === 'DNNBC'" src="assets/icon/check-mark.svg" alt="circle" />
          </div>
        </div>
      </div>
      <div class="input-block-2">
        <p class="text-2">Comments</p>
        <textarea class="input-2" formControlName="Comments" name="comments" id="" cols="30" rows="10"></textarea>
      </div>
    </div>
    <p class="subtitle-lg">Signature</p>
    <ion-row class="ion-justify-content-center">
      <ion-col size="auto">
        <canvas #sPad width="250" height="200" style="touch-action: none; border: 1px solid black"></canvas>
      </ion-col>
    </ion-row>

    <p class="subtitle-lg">Mechanical Signature</p>
    <ion-row class="ion-justify-content-center">
      <ion-col size="auto">
        <canvas *ngIf="form.value.StatusCode === 'DC'" required #mechanicSPad width="250" height="200" style="touch-action: none; border: 1px solid black"></canvas>
      </ion-col>
    </ion-row>
    <button class="btn primary-btn" [disabled]="!form.valid" color="success" (click)="onSubmit()" expand="block">Save</button>
  </form>
</ion-content>
