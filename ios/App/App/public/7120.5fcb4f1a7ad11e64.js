"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7120],{2187:(E,_,a)=>{a.d(_,{a:()=>M});var n=a(8256),m=a(4465),h=a(6994),f=a(6895),g=a(4006);const p=function(u,t,o,v){return{"label-error":u,"input-label-top":t,"input-label-left":o,"no-label":v}};function i(u,t){if(1&u&&(n.TgZ(0,"div",3),n._uU(1),n.qZA()),2&u){const o=n.oxw();n.Q6J("ngClass",n.l5B(3,p,!o.valid,"top"===o.labelPosition,"left"===o.labelPosition,"none"===o.label)),n.xp6(1),n.AsE(" ",o.label,"",o.required?"*":""," ")}}const P=function(u,t){return{"custom-input-top":u,"custom-input-left":t}},d=function(u,t,o){return{"input-fill":u,"validation-error":t,"input-left":o}};let M=(()=>{class u{constructor(o,v){this.toastService=o,this.shareService=v,this.type="text",this.placeholder="",this.fill=!0,this.validators=[],this.noValidation=!1,this.disabled=!1,this.required=!1,this.labelPosition="top",this.valueChange=new n.vpe,this.validationChange=new n.vpe,this.valid=!0}get value(){return this._value}set value(o){this._value!==o&&(this._value=o,this.valueChange.emit(o))}get validation(){return this._validation}set validation(o){this._validation!==o&&(this._validation=o,this.validationChange.emit(o))}ngOnInit(){this.validateSubscription=this.shareService.currentMessage.subscribe(o=>{"reset"===o?this.valid=!0:o&&0!==o.length&&this.validateInput()})}ngOnDestroy(){this.validateSubscription.unsubscribe()}onInputChange(o){0!==o.target.value&&(this.valid=!0),this.value=o.target.value,this.valueChange.emit(this.value)}validateInput(){this.noValidation||(0===this.value.length?(this.valid=!1,this.toastService.showToast("Field required")):this.value.length>0&&(this.valid=!0),this.value.length>=0&&0!==this.validators.length&&this.validators.every(o=>!!o.regex.test(this.value)||(this.valid=!0,this.toastService.showToast(o.message),!1)),this.validation=this.valid)}}return u.\u0275fac=function(o){return new(o||u)(n.Y36(m.k),n.Y36(h.t))},u.\u0275cmp=n.Xpm({type:u,selectors:[["app-input"]],inputs:{label:"label",type:"type",placeholder:"placeholder",fill:"fill",validators:"validators",noValidation:"noValidation",disabled:"disabled",required:"required",labelPosition:"labelPosition",value:"value",validation:"validation"},outputs:{valueChange:"valueChange",validationChange:"validationChange"},decls:3,vars:14,consts:[[1,"custom-input",3,"ngClass"],["class","input-label",3,"ngClass",4,"ngIf"],[1,"input-box",3,"type","ngModel","disabled","placeholder","ngClass","input","ngModelChange"],[1,"input-label",3,"ngClass"]],template:function(o,v){1&o&&(n.TgZ(0,"div",0),n.YNc(1,i,2,8,"div",1),n.TgZ(2,"input",2),n.NdJ("input",function(y){return v.onInputChange(y)})("ngModelChange",function(y){return v.value=y}),n.qZA()()),2&o&&(n.Q6J("ngClass",n.WLB(7,P,"top"===v.labelPosition,"left"===v.labelPosition)),n.xp6(1),n.Q6J("ngIf",v.label),n.xp6(1),n.Q6J("type",v.type)("ngModel",v.value)("disabled",v.disabled)("placeholder",v.placeholder)("ngClass",n.kEZ(10,d,v.fill,!v.valid,"left"===v.labelPosition)))},dependencies:[f.mk,f.O5,g.Fj,g.JJ,g.On],styles:[".custom-input[_ngcontent-%COMP%]{width:100%;height:-moz-fit-content;height:fit-content}.custom-input-top[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:5px}.custom-input-left[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;gap:24px}.input-label[_ngcontent-%COMP%]{color:var(--gray-500)}.input-label-top[_ngcontent-%COMP%]{font-size:14px;font-weight:500}.input-label-left[_ngcontent-%COMP%]{flex:1;font-size:15px;font-weight:600}.input-box[_ngcontent-%COMP%]{width:100%;height:45px;border-radius:10px;padding:15px;font-size:14px;font-weight:400;color:var(--gray-500)!important;border:1px solid var(--gray-200);background-color:#fff}.input-box[_ngcontent-%COMP%]:focus{color:var(--gray-500)!important;outline:none;border:1px solid var(--gray-300)}.input-fill[_ngcontent-%COMP%]{border:none!important;background-color:var(--gray-100)}.input-left[_ngcontent-%COMP%]{flex:1}.validation-error[_ngcontent-%COMP%]{border:1px solid var(--error-600)!important}.validation-error[_ngcontent-%COMP%]:focus{border:1px solid var(--error-600)!important}.label-error[_ngcontent-%COMP%]{color:var(--error-600)}.no-label[_ngcontent-%COMP%]{color:transparent!important}"]}),u})()},4166:(E,_,a)=>{a.d(_,{v:()=>g});var n=a(6895),m=a(4006),h=a(6114),f=a(8256);let g=(()=>{class p{}return p.\u0275fac=function(P){return new(P||p)},p.\u0275mod=f.oAB({type:p}),p.\u0275inj=f.cJS({imports:[n.ez,m.u5,h.Pc]}),p})()},7120:(E,_,a)=>{a.r(_),a.d(_,{LoginPageModule:()=>z});var n=a(6895),m=a(4006),h=a(6114),f=a(4529),g=a(5861),p=a(4128),i=a(2843),P=a(3900),d=a(262),M=a(8746),u=a(7423),t=a(8256),o=a(7556),v=a(4761),O=a(4382),y=a(4465),I=a(849),A=a(7278),x=a(6994),U=a(7972),K=a(2187);function Z(l,C){1&l&&(t.TgZ(0,"span"),t._uU(1,"Login"),t.qZA())}function R(l,C){1&l&&t._UZ(0,"ion-spinner",12)}const B=[{path:"",component:(()=>{class l{constructor(r,s,e,c,S,T,b,D,L){this.authService=r,this.manageService=s,this.databaseService=e,this.toastService=c,this.storage=S,this.navCtrl=T,this.utilityService=b,this.shareService=D,this.locationService=L,this.username="",this.password="",this.loading=!1,this.focused=!1,this.validation={username:!1,password:!1}}ngOnInit(){}ngOnDestroy(){this.shareService.destroyMessage()}login(r,s){var e=this;return(0,g.Z)(function*(){if(e.shareService.changeMessage(e.utilityService.generateString(5)),e.utilityService.validateForm(e.validation)){if("web"!==u.dV.getPlatform()){if(!(yield e.locationService.checkLocationServices()))return void alert("Please Turn On Location Service.\nGo to Settings -> Location -> Toggle on the Location Service.");if(yield e.locationService.requestPermission(),!(yield e.locationService.checkPermission()))return void alert("The location permission is requiered to open the app.")}e.loading=!0,e.authService.login(r,s).pipe((0,P.w)(c=>(e.authUser=c,e.storage.set("accessToken",c.AccessToken),e.storage.set("driverId",c.DriverId),e.storage.set("companyId",c.CompanyId),e.storage.set("name",c.Name),localStorage.setItem("accessToken",c.AccessToken),e.saveAuthUser(c))),(0,P.w)(()=>{const c=[e.manageService.getDrivers(),e.manageService.getCompany(),e.manageService.getVehicles(),e.manageService.getTerminals(),e.manageService.getELDs(),e.manageService.getDVIRs(),e.manageService.getLogDailies(e.authUser.DriverId,(0,n.p6)(new Date,"yyyy-MM-dd","en_US"),14),e.manageService.getLogEvents(e.authUser.DriverId),e.manageService.getPlacesCity()];return(0,p.D)(c).pipe((0,d.K)(S=>{const T="Error fetching data";return e.toastService.showToast(T),(0,i._)(T)}))}),(0,P.w)(([c,S,T,b,D,L,F,j,N])=>{const Q=[e.saveDrivers(c),e.saveCompany(S),e.saveVehicles(T),e.saveTerminals(b),e.saveDVIRs(L),e.saveELDs(D),e.saveLogDailies(F),e.saveLogEvents(j),e.savePlacesCity(N)];return(0,p.D)(Q).pipe((0,d.K)(G=>{const w="Error saving data to database";return e.toastService.showToast(w),(0,i._)(w)}))}),(0,M.x)(()=>{e.loading=!1})).subscribe(()=>{e.storage.set("bAuthorized",!1),e.toastService.showToast("Login successful","success"),e.navCtrl.navigateRoot("/select-vehicle",{animated:!0,animationDirection:"forward"})},c=>{const S="An error occurred during login";e.toastService.showToast(S,"danger"),console.log(S)})}})()}saveAuthUser(r){return this.databaseService.saveAuthUser(r).pipe((0,d.K)(s=>{const e="Error saving auth user to database";return this.toastService.showToast(e),(0,i._)(e)}))}saveDrivers(r){return this.databaseService.saveDrivers(r).pipe((0,d.K)(s=>{const e="Error saving drivers to database";return this.toastService.showToast(e),(0,i._)(e)}))}saveCompany(r){return this.databaseService.saveCompany(r).pipe((0,d.K)(s=>{const e="Error saving company to database";return this.toastService.showToast(e),(0,i._)(e)}))}saveVehicles(r){return this.databaseService.saveVehicles(r).pipe((0,d.K)(s=>{const e="Error saving vehicles to database";return this.toastService.showToast(e),(0,i._)(e)}))}saveTerminals(r){return this.databaseService.saveTerminals(r).pipe((0,d.K)(s=>{const e="Error saving terminals to database";return this.toastService.showToast(e),(0,i._)(e)}))}saveELDs(r){return this.databaseService.saveELDs(r).pipe((0,d.K)(s=>{const e="Error saving ELDs to database";return this.toastService.showToast(e),(0,i._)(e)}))}saveDVIRs(r){return this.databaseService.saveDvirs(r).pipe((0,d.K)(s=>{const e="Error saving dvirs to database";return this.toastService.showToast(e),(0,i._)(e)}))}savePlacesCity(r){return this.databaseService.savePlacesCity(r).pipe((0,d.K)(s=>{const e="Error saving logMaps to database";return this.toastService.showToast(e),(0,i._)(e)}))}saveLogDailies(r){return this.databaseService.saveLogDailies(r).pipe((0,d.K)(s=>{const e="Error saving log dailies to database";return this.toastService.showToast(e),(0,i._)(e)}))}saveLogEvents(r){return this.databaseService.saveLogEvents(r).pipe((0,d.K)(s=>{const e="Error saving log histories to database";return this.toastService.showToast(e),(0,i._)(e)}))}forgotPassword(){}}return l.\u0275fac=function(r){return new(r||l)(t.Y36(o.e),t.Y36(v.N),t.Y36(O.k),t.Y36(y.k),t.Y36(I.K),t.Y36(h.SH),t.Y36(A.t),t.Y36(x.t),t.Y36(U.a))},l.\u0275cmp=t.Xpm({type:l,selectors:[["app-login"]],decls:15,vars:12,consts:[["forceOverscroll","false"],[1,"login-wrapper"],["src","assets/imgs/login-img.png","alt","truck",1,"image"],[1,"login-form-container"],[1,"title"],[1,"form-login"],[3,"label","fill","type","value","validation","valueChange","validationChange"],[2,"display","flex","flex-direction","column"],[1,"forgot-password",3,"click"],[1,"btn-login","primary-btn","f-submit-button",3,"click","keydown.enter"],[4,"ngIf"],["name","circular","color","light",4,"ngIf"],["name","circular","color","light"]],template:function(r,s){1&r&&(t.TgZ(0,"ion-content",0)(1,"div",1),t._UZ(2,"img",2),t.TgZ(3,"div",3)(4,"div",4),t._uU(5,"Welcome to ZigZag ELD"),t.qZA(),t.TgZ(6,"div",5)(7,"app-input",6),t.NdJ("valueChange",function(c){return s.username=c})("validationChange",function(c){return s.validation.username=c}),t.qZA(),t.TgZ(8,"div",7)(9,"app-input",6),t.NdJ("valueChange",function(c){return s.password=c})("validationChange",function(c){return s.validation.password=c}),t.qZA(),t.TgZ(10,"div",8),t.NdJ("click",function(){return s.forgotPassword()}),t._uU(11,"Forgot Password?"),t.qZA()(),t.TgZ(12,"button",9),t.NdJ("click",function(){return s.login(s.username,s.password)})("keydown.enter",function(){return s.login(s.username,s.password)}),t.YNc(13,Z,2,0,"span",10),t.YNc(14,R,1,0,"ion-spinner",11),t.qZA()()()()()),2&r&&(t.xp6(7),t.Q6J("label","Username")("fill",!1)("type","text")("value",s.username)("validation",s.validation.username),t.xp6(2),t.Q6J("label","Password")("fill",!1)("type","password")("value",s.password)("validation",s.validation.password),t.xp6(4),t.Q6J("ngIf",!s.loading),t.xp6(1),t.Q6J("ngIf",s.loading))},dependencies:[n.O5,h.W2,h.PQ,K.a],styles:[".login-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:30px}.login-wrapper[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{text-align:center;margin-bottom:30px}.login-wrapper[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{border-radius:unset;width:100%}.login-wrapper[_ngcontent-%COMP%]   .form-login[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:30px}.login-wrapper[_ngcontent-%COMP%]   .form-login[_ngcontent-%COMP%]   .btn-login[_ngcontent-%COMP%]{width:100%;height:50px;border-radius:40px}.login-form-container[_ngcontent-%COMP%]{padding:0 30px}.f-submit-button[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.forgot-password[_ngcontent-%COMP%]{align-self:flex-end;margin-top:5px;font-size:14px;font-weight:400;color:var(--gray-500)}.forgot-password[_ngcontent-%COMP%]:hover{text-decoration:underline}"]}),l})()}];let J=(()=>{class l{}return l.\u0275fac=function(r){return new(r||l)},l.\u0275mod=t.oAB({type:l}),l.\u0275inj=t.cJS({imports:[f.Bz.forChild(B),f.Bz]}),l})(),W=(()=>{class l{}return l.\u0275fac=function(r){return new(r||l)},l.\u0275mod=t.oAB({type:l}),l.\u0275inj=t.cJS({imports:[n.ez,m.u5]}),l})();var Y=a(4166);let z=(()=>{class l{}return l.\u0275fac=function(r){return new(r||l)},l.\u0275mod=t.oAB({type:l}),l.\u0275inj=t.cJS({providers:[O.k,I.K],imports:[n.ez,m.u5,h.Pc,J,W,Y.v]}),l})()},6994:(E,_,a)=>{a.d(_,{t:()=>f});var n=a(7579),m=a(1135),h=a(8256);let f=(()=>{class g{constructor(){this.editDataDetails=[],this.subject=new n.x,this.messageSource=new m.X(this.editDataDetails),this.currentMessage=this.messageSource.asObservable()}changeMessage(i){this.messageSource.next(i)}destroyMessage(){this.messageSource.next("")}}return g.\u0275fac=function(i){return new(i||g)},g.\u0275prov=h.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})()},4465:(E,_,a)=>{a.d(_,{k:()=>f});var n=a(5861),m=a(8256),h=a(6114);let f=(()=>{class g{constructor(i){this.toastController=i}showToast(i,P="danger",d=1e3){var M=this;return(0,n.Z)(function*(){M.currentToast&&(yield M.dismissToast());const u=yield M.toastController.create({message:i,duration:d,color:P});M.currentToast=u,u.onDidDismiss().then(()=>{M.currentToast=null}),u.present()})()}dismissToast(){var i=this;return(0,n.Z)(function*(){i.currentToast&&(yield i.toastController.dismiss(),i.currentToast=null)})()}}return g.\u0275fac=function(i){return new(i||g)(m.LFG(h.yF))},g.\u0275prov=m.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})()}}]);