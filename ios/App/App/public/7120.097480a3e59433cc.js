"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7120],{7120:(N,m,n)=>{n.r(m),n.d(m,{LoginPageModule:()=>O});var u=n(6895),d=n(4006),p=n(6114),f=n(4529),C=n(5861),M=n(4128),o=n(2843),v=n(3900),i=n(262),L=n(8746),e=n(8256),S=n(7556),b=n(4761),P=n(4382),T=n(849);function D(r,l){1&r&&(e.TgZ(0,"span"),e._uU(1,"Login"),e.qZA())}function Z(r,l){1&r&&e._UZ(0,"ion-spinner",14)}const E=[{path:"",component:(()=>{class r{constructor(s,a,t,g,c,h){this.authService=s,this.manageService=a,this.databaseService=t,this.toastController=g,this.storage=c,this.navCtrl=h,this.username="",this.password="",this.loading=!1,this.focused=!1}ngOnInit(){}onBlur(s){s.target.value||(this.focused=!1)}login(s,a){this.loading=!0,this.authService.login(s,a).pipe((0,v.w)(t=>(this.authUser=t,this.storage.set("accessToken",t.AccessToken),this.storage.set("driverId",t.DriverId),this.storage.set("companyId",t.CompanyId),this.storage.set("name",t.Name),localStorage.setItem("accessToken",t.AccessToken),this.saveAuthUser(t))),(0,v.w)(()=>{const t=[this.manageService.getDrivers(),this.manageService.getCompany(),this.manageService.getVehicles(),this.manageService.getTerminals(),this.manageService.getELDs(),this.manageService.getDVIRs(),this.manageService.getLogDailies(this.authUser.DriverId,(0,u.p6)(new Date,"yyyy-MM-dd","en_US"),14),this.manageService.getLogHistories14Days(this.authUser.DriverId),this.manageService.getPlacesCity()];return(0,M.D)(t).pipe((0,i.K)(g=>{const c="Error fetching data";return this.presentToast(c),(0,o._)(c)}))}),(0,v.w)(([t,g,c,h,I,J,K,U,x])=>{const F=[this.saveDrivers(t),this.saveCompany(g),this.saveVehicles(c),this.saveTerminals(h),this.saveDVIRs(J),this.saveELDs(I),this.saveLogDailies(K),this.saveLogHistories(U),this.savePlacesCity(x)];return(0,M.D)(F).pipe((0,i.K)(Y=>{const y="Error saving data to database";return this.presentToast(y),(0,o._)(y)}))}),(0,L.x)(()=>{this.loading=!1})).subscribe(()=>{this.storage.set("bAuthorized",!1),this.presentToast("Login successful","success"),this.navCtrl.navigateForward("/select-vehicle")},t=>{const g="An error occurred during login";this.presentToast(g,"danger"),console.log(g)})}saveAuthUser(s){return this.databaseService.saveAuthUser(s).pipe((0,i.K)(a=>{const t="Error saving auth user to database";return this.presentToast(t),(0,o._)(t)}))}saveDrivers(s){return this.databaseService.saveDrivers(s).pipe((0,i.K)(a=>{const t="Error saving drivers to database";return this.presentToast(t),(0,o._)(t)}))}saveCompany(s){return this.databaseService.saveCompany(s).pipe((0,i.K)(a=>{const t="Error saving company to database";return this.presentToast(t),(0,o._)(t)}))}saveVehicles(s){return this.databaseService.saveVehicles(s).pipe((0,i.K)(a=>{const t="Error saving vehicles to database";return this.presentToast(t),(0,o._)(t)}))}saveTerminals(s){return this.databaseService.saveTerminals(s).pipe((0,i.K)(a=>{const t="Error saving terminals to database";return this.presentToast(t),(0,o._)(t)}))}saveELDs(s){return this.databaseService.saveELDs(s).pipe((0,i.K)(a=>{const t="Error saving ELDs to database";return this.presentToast(t),(0,o._)(t)}))}saveDVIRs(s){return this.databaseService.saveDvirs(s).pipe((0,i.K)(a=>{const t="Error saving dvirs to database";return this.presentToast(t),(0,o._)(t)}))}savePlacesCity(s){return this.databaseService.savePlacesCity(s).pipe((0,i.K)(a=>{const t="Error saving logMaps to database";return this.presentToast(t),(0,o._)(t)}))}saveLogDailies(s){return this.databaseService.saveLogDailies(s).pipe((0,i.K)(a=>{const t="Error saving log dailies to database";return this.presentToast(t),(0,o._)(t)}))}saveLogHistories(s){return this.databaseService.saveLogHistories(s).pipe((0,i.K)(a=>{const t="Error saving log histories to database";return this.presentToast(t),(0,o._)(t)}))}presentToast(s,a="danger"){var t=this;return(0,C.Z)(function*(){(yield t.toastController.create({message:s,duration:3e3,color:a})).present()})()}forgotPassword(){}}return r.\u0275fac=function(s){return new(s||r)(e.Y36(S.e),e.Y36(b.N),e.Y36(P.k),e.Y36(p.yF),e.Y36(T.K),e.Y36(p.SH))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-login"]],decls:20,vars:4,consts:[["forceOverscroll","false"],[1,"login-wrapper"],["src","assets/imgs/login-img.png","alt","truck",1,"image"],[1,"login-form-container"],[1,"title"],[1,"form-login"],[1,"input-block"],[1,"label"],["type","email","name","username",1,"input",3,"ngModel","ngModelChange"],["type","password","name","password",1,"input",3,"ngModel","ngModelChange"],[1,"forgot-password",3,"click"],[1,"btn-login","primary-btn","f-submit-button",3,"click"],[4,"ngIf"],["name","circular","color","light",4,"ngIf"],["name","circular","color","light"]],template:function(s,a){1&s&&(e.TgZ(0,"ion-content",0)(1,"div",1),e._UZ(2,"img",2),e.TgZ(3,"div",3)(4,"div",4),e._uU(5,"Welcome to ZigZag ELD"),e.qZA(),e.TgZ(6,"div",5)(7,"div",6)(8,"div",7),e._uU(9,"Email"),e.qZA(),e.TgZ(10,"input",8),e.NdJ("ngModelChange",function(g){return a.username=g}),e.qZA()(),e.TgZ(11,"div",6)(12,"div",7),e._uU(13,"Password"),e.qZA(),e.TgZ(14,"input",9),e.NdJ("ngModelChange",function(g){return a.password=g}),e.qZA(),e.TgZ(15,"div",10),e.NdJ("click",function(){return a.forgotPassword()}),e._uU(16,"Forgot Password?"),e.qZA()(),e.TgZ(17,"button",11),e.NdJ("click",function(){return a.login(a.username,a.password)}),e.YNc(18,D,2,0,"span",12),e.YNc(19,Z,1,0,"ion-spinner",13),e.qZA()()()()()),2&s&&(e.xp6(10),e.Q6J("ngModel",a.username),e.xp6(4),e.Q6J("ngModel",a.password),e.xp6(4),e.Q6J("ngIf",!a.loading),e.xp6(1),e.Q6J("ngIf",a.loading))},dependencies:[u.O5,d.Fj,d.JJ,d.On,p.W2,p.PQ],styles:[".login-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:30px}.login-wrapper[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{text-align:center;margin-bottom:30px}.login-wrapper[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{border-radius:unset;width:100%}.login-wrapper[_ngcontent-%COMP%]   .form-login[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:30px}.login-wrapper[_ngcontent-%COMP%]   .form-login[_ngcontent-%COMP%]   .btn-login[_ngcontent-%COMP%]{width:100%;height:50px;border-radius:40px}.login-form-container[_ngcontent-%COMP%]{padding:0 30px}.f-submit-button[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.forgot-password[_ngcontent-%COMP%]{align-self:flex-end;margin-top:5px;font-size:14px;font-weight:400;color:var(--gray-500)}.forgot-password[_ngcontent-%COMP%]:hover{text-decoration:underline}"]}),r})()}];let w=(()=>{class r{}return r.\u0275fac=function(s){return new(s||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[f.Bz.forChild(E),f.Bz]}),r})(),A=(()=>{class r{}return r.\u0275fac=function(s){return new(s||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[u.ez,d.u5]}),r})(),O=(()=>{class r{}return r.\u0275fac=function(s){return new(s||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({providers:[P.k,T.K],imports:[u.ez,d.u5,p.Pc,w,A]}),r})()}}]);